# MySQL InnoDB

- MySQL 서버는 사람의 머리 역할을 하는 MySQL 엔진과 손발 역할을 담당하는 스토리지 엔진으로 구분할 수 있다.
  - MySQL 엔진은 요청된 SQL을 분석하거나 최적화하는 등 DBMS의 두뇌에 해당하는 처리를 한다.
  - 스토리지 엔진은 실제 데이터를 디스크에 저장하거나 데이터를 읽어오는 역할을 맡는다.
- 이번 문서에서는 스토리지 엔진에 속하는 InnoDB의 특성을 살펴본다.

## 프라이머리 키에 대한 클러스터링

- InnoDB의 모든 테이블은 기본적으로 PK를 기준으로 클러스터링 되어 저장된다. 즉 PK 순서대로 디스크에 저장된다는 의미이며, 모든 세컨더리 인덱스는 리프 노드에 레코드의 주소 대신 PK 값을 가리킨다. PK를 활용한 조회나 범위 검색이 매우 빠르기 때문에 다른 보조 인덱스에 비해 PK가 선택될 확률이 높다.
- 8.8절에서 다시 강화할 예정

## 외래 키 지원

- 외래 키 기능은 InnoDB 스토리지 엔진 레벨에서 지원하는 기능으로 서버 운영의 불편함 때문에 실무에서 생성하지 않는 경우도 많다.
- 외래 키는 부모와 자식 테이블 모두 해당 컬럼에 인덱스를 생성하고, 변경 시 부모 테이블이나 자식 테이블에 데이터가 있는지 체크하는 작업이 필요해 잠금이 여러 테이블로 전파되어 데드락이 발생할 때가 많으므로 외래 키의 존재에 주의한 것이 좋다.
- 또한 수동으로 데이터를 적재하거나 스키마 변경 등의 관리 작업이 실패할 수 있다. 외래키가 복잡하게 얽혀있다면 테이블 관계를 명확히 파악해서 순서대로 작업해야 하지만, 긴급하게 조치를 해야 하는데 이런 문제가 발생하면 더 조급해질 수 있다.
